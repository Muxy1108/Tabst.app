@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
	:root {
		--radius: 0.375rem;

		/* 动画时间变量 */
		--transition-fast: 100ms ease-out;
		--transition-normal: 200ms cubic-bezier(0.4, 0, 0.2, 1);
		--transition-spring: 300ms cubic-bezier(0.34, 1.56, 0.64, 1);

		/* 默认主题变量（会被动态覆盖） */
		--background: 0 0% 100%;
		--foreground: 210 13% 16%;
		--card: 0 0% 100%;
		--card-foreground: 210 13% 16%;
		--popover: 0 0% 100%;
		--popover-foreground: 210 13% 16%;
		--primary: 212 92% 45%;
		--primary-foreground: 0 0% 100%;
		--secondary: 210 29% 97%;
		--secondary-foreground: 210 13% 16%;
		--muted: 210 29% 97%;
		--muted-foreground: 210 9% 41%;
		--accent: 210 29% 97%;
		--accent-foreground: 210 13% 16%;
		--destructive: 356 71% 53%;
		--destructive-foreground: 0 0% 100%;
		--border: 213 27% 84%;
		--input: 213 27% 84%;
		--ring: 212 92% 45%;
		--selection-overlay: rgba(0, 0, 0, 0.03);
		--scrollbar: hsl(213 27% 84% / 0.9);
		--focus-ring: rgb(59 130 246);
		--highlight-bg: rgba(59, 130, 246, 0.2);
		--highlight-text: rgb(37, 99, 235);
		--hover-bg: rgba(59, 130, 246, 0.1);
		--hover-text: rgb(37, 99, 235);

		/* AlphaTab 默认颜色 */
		--alphatab-main-glyph: #0f172a;
		--alphatab-secondary-glyph: rgba(15, 23, 42, 0.6);
		--alphatab-staff-line: #cbd5e1;
		--alphatab-bar-separator: #cbd5e1;
		--alphatab-bar-number: #475569;
		--alphatab-score-info: #1e293b;

		--player-cursor-bg: rgba(59, 130, 246, 0.4);
		--player-cursor-border: rgb(37, 99, 235);
		--player-cursor-highlight: rgba(59, 130, 246, 0.15);
	}

	.dark {
		--background: 216 28% 7%;
		--foreground: 212 12% 82%;
		--card: 216 28% 7%;
		--card-foreground: 212 12% 82%;
		--popover: 215 28% 10%;
		--popover-foreground: 212 12% 82%;
		--primary: 212 92% 58%;
		--primary-foreground: 0 0% 100%;
		--secondary: 215 28% 10%;
		--secondary-foreground: 212 12% 82%;
		--muted: 215 28% 10%;
		--muted-foreground: 212 10% 56%;
		--accent: 215 28% 10%;
		--accent-foreground: 212 12% 82%;
		--destructive: 356 60% 45%;
		--destructive-foreground: 0 0% 100%;
		--border: 215 14% 21%;
		--input: 215 14% 21%;
		--ring: 212 92% 58%;
		--selection-overlay: rgba(255, 255, 255, 0.03);
		--scrollbar: hsl(215 14% 21% / 0.9);
		--focus-ring: rgb(96 165 250);
		--highlight-bg: rgba(96, 165, 250, 0.2);
		--highlight-text: rgb(96, 165, 250);
		--hover-bg: rgba(96, 165, 250, 0.1);
		--hover-text: rgb(96, 165, 250);

		--alphatab-main-glyph: #f1f5f9;
		--alphatab-secondary-glyph: rgba(241, 245, 249, 0.6);
		--alphatab-staff-line: #475569;
		--alphatab-bar-separator: #475569;
		--alphatab-bar-number: #94a3b8;
		--alphatab-score-info: #cbd5e1;

		--player-cursor-bg: rgba(96, 165, 250, 0.4);
		--player-cursor-border: rgb(96, 165, 250);
		--player-cursor-highlight: rgba(96, 165, 250, 0.15);
	}
}

@layer base {
	* {
		@apply border-border;
	}

	body {
		@apply bg-background text-foreground;
	}

	/* Global scrollbar styling for modern Chromium and Firefox */
	*::-webkit-scrollbar {
		width: 10px;
		height: 10px;
	}

	*::-webkit-scrollbar-track {
		background: transparent;
	}

	*::-webkit-scrollbar-thumb {
		background-color: var(--scrollbar);
		border-radius: 9999px;
		border: 2px solid transparent;
		background-clip: padding-box;
	}

	*::-webkit-scrollbar-thumb:hover {
		background-color: var(--scrollbar);
		opacity: 0.8;
	}

	*::-webkit-scrollbar-button {
		display: none;
		width: 0;
		height: 0;
	}

	*::-webkit-scrollbar-corner {
		background: transparent;
	}

	/* Firefox scrollbar */
	* {
		scrollbar-width: thin;
		scrollbar-color: var(--scrollbar) transparent;
	}

	:focus {
		outline: none;
	}

	:focus-visible {
		outline: none;
		box-shadow: 0 0 0 1px var(--focus-ring);
		border-radius: 2px;
	}

	::selection {
		background-color: var(--selection-overlay);
		color: inherit;
	}
}

@layer components {
	/* 标准焦点样式 */
	.focus-ring {
		@apply focus:outline-none focus:ring-1 focus:ring-[var(--focus-ring)] focus:ring-offset-0;
		transition: box-shadow var(--transition-normal);
	}

	.focus-ring-bg {
		@apply focus:outline-none focus:ring-1 focus:ring-[var(--focus-ring)] focus:ring-offset-0;
		transition:
			box-shadow var(--transition-normal),
			background-color var(--transition-fast);
	}

	.focus-input {
		@apply focus:outline-none focus:ring-1 focus:ring-[var(--focus-ring)] focus:border-[var(--focus-ring)];
		transition:
			box-shadow var(--transition-normal),
			border-color var(--transition-normal);
	}

	/* 悬停效果 */
	.hover-lift {
		transition:
			transform var(--transition-fast),
			box-shadow var(--transition-fast);
	}
	.hover-lift:hover {
		transform: translateY(-1px);
	}

	/* 按钮按压效果 */
	.btn-press {
		transition: transform var(--transition-fast);
	}
	.btn-press:active {
		transform: scale(0.97);
	}

	/* 淡入动画 */
	.fade-in {
		animation: fadeIn var(--transition-normal) ease-out;
	}

	/* 滑入动画 */
	.slide-up {
		animation: slideUp var(--transition-spring) ease-out;
	}

	/* 脉冲效果 */
	.pulse-soft {
		animation: pulseSoft 2s ease-in-out infinite;
	}

	/* 平滑过渡 */
	.transition-smooth {
		transition: all var(--transition-normal);
	}

	/* CodeMirror 特殊处理 */
	.cm-editor:focus-visible,
	.cm-editor *:focus-visible,
	.cm-content:focus-visible,
	.cm-scroller:focus-visible {
		outline: none;
		box-shadow: none;
	}

	.cm-content ::selection,
	.cm-line ::selection {
		background-color: var(--selection-overlay);
		color: inherit;
	}
}

@layer utilities {
	/* 滚动条样式 */
	.scrollbar-thin {
		scrollbar-width: thin;
		scrollbar-color: var(--scrollbar) transparent;
	}

	.scrollbar-thin::-webkit-scrollbar {
		width: 10px;
		height: 10px;
	}

	.scrollbar-thin::-webkit-scrollbar-track {
		background: transparent;
	}

	.scrollbar-thin::-webkit-scrollbar-thumb {
		background-color: var(--scrollbar);
		border-radius: 9999px;
		border: 2px solid transparent;
		background-clip: padding-box;
	}

	.scrollbar-thin::-webkit-scrollbar-button {
		display: none;
		width: 0;
		height: 0;
	}

	.scrollbar-thin::-webkit-scrollbar-corner {
		background: transparent;
	}
}

/* 关键帧动画 */
@keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

@keyframes slideUp {
	from {
		opacity: 0;
		transform: translateY(10px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

@keyframes pulseSoft {
	0%,
	100% {
		opacity: 1;
	}
	50% {
		opacity: 0.7;
	}
}

/* AlphaTab 光标和选择样式 */
.alpha-cursor,
.at-cursor-bar {
	pointer-events: none;
	position: absolute;
	background: rgba(255, 242, 0, 0.25);
	transition:
		left 100ms linear,
		top 100ms linear,
		width 100ms linear,
		height 100ms linear;
	z-index: 20;
	border-radius: 2px;
}

.at-cursor-beat {
	position: absolute;
	pointer-events: none;
	background: rgba(64, 64, 255, 0.75);
	width: 3px;
	z-index: 25;
	transition:
		left 80ms linear,
		top 80ms linear;
}

.at-selection div {
	background: rgba(64, 64, 255, 0.1);
}

.at-highlight * {
	fill: #0078ff;
	stroke: #0078ff;
}

/* 输入框移除微调按钮 */
.input-no-spinner::-webkit-outer-spin-button,
.input-no-spinner::-webkit-inner-spin-button {
	-webkit-appearance: none;
	margin: 0;
}
.input-no-spinner {
	-moz-appearance: textfield;
	appearance: textfield;
}

/* 代码块样式覆盖 */
.code-block-no-text-bg span,
.code-block-no-text-bg span[style*="background"],
.code-block-no-text-bg span[style*="background-color"] {
	background: transparent;
	background-color: transparent;
}
