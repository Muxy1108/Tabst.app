@tailwind base;
@tailwind components;
@tailwind utilities;

/* 统一焦点样式 - 可复用的工具类 */
@layer components {
	/* 标准焦点样式 - 用于按钮、链接等交互元素 */
	.focus-ring {
		@apply focus:outline-none focus:ring-1 focus:ring-blue-500 focus:ring-offset-0;
	}

	/* 焦点样式 - 带背景高亮 */
	.focus-ring-bg {
		@apply focus:outline-none focus:ring-1 focus:ring-blue-500 focus:ring-offset-0 focus:bg-blue-500/20;
	}

	/* 输入框焦点样式 */
	.focus-input {
		@apply focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500;
	}
}

@layer base {
	:root {
		/* GitHub Light Theme */
		--background: 0 0% 100%; /* #ffffff */
		--foreground: 210 13% 16%; /* #24292f */

		--card: 0 0% 100%;
		--card-foreground: 210 13% 16%;

		--popover: 0 0% 100%;
		--popover-foreground: 210 13% 16%;

		--primary: 212 92% 45%; /* #0969da */
		--primary-foreground: 0 0% 100%;

		--secondary: 210 29% 97%; /* #f6f8fa */
		--secondary-foreground: 210 13% 16%;

		--muted: 210 29% 97%;
		--muted-foreground: 210 9% 41%; /* #57606a */

		--accent: 210 29% 97%;
		--accent-foreground: 210 13% 16%;

		--destructive: 356 71% 53%; /* #cf222e */
		--destructive-foreground: 0 0% 100%;

		--border: 213 27% 84%; /* #d0d7de */
		--input: 213 27% 84%;
		--ring: 212 92% 45%;

		--radius: 0.375rem;
		/* Selection overlay for subtle highlight (light theme): apply a slight dark translucent overlay */
		--selection-overlay: rgba(0, 0, 0, 0.03);

		/* AlphaTab notation colors - Light Theme */
		--alphatab-main-glyph: #0f172a; /* slate-900 */
		--alphatab-secondary-glyph: rgba(15, 23, 42, 0.6); /* slate-900 60% */
		--alphatab-staff-line: #cbd5e1; /* slate-300 */
		--alphatab-bar-separator: #cbd5e1; /* slate-300 */
		--alphatab-bar-number: #475569; /* slate-600 */
		--alphatab-score-info: #1e293b; /* slate-800 */
	}

	.dark {
		/* GitHub Dark Theme */
		--background: 216 28% 7%; /* #0d1117 */
		--foreground: 212 12% 82%; /* #c9d1d9 */

		--card: 216 28% 7%;
		--card-foreground: 212 12% 82%;

		--popover: 215 28% 10%; /* #161b22 */
		--popover-foreground: 212 12% 82%;

		--primary: 212 92% 58%; /* #2f81f7 */
		--primary-foreground: 0 0% 100%;

		--secondary: 215 28% 10%; /* #161b22 */
		--secondary-foreground: 212 12% 82%;

		--muted: 215 28% 10%;
		--muted-foreground: 212 10% 56%; /* #8b949e */

		--accent: 215 28% 10%;
		--accent-foreground: 212 12% 82%;

		--destructive: 356 60% 45%; /* #a40e26 - adjusted for dark mode visibility if needed, but keeping standard red */
		--destructive-foreground: 0 0% 100%;

		--border: 215 14% 21%; /* #30363d */
		--input: 215 14% 21%;
		--ring: 212 92% 58%;
		/* Selection overlay for dark theme: slight bright translucent overlay */
		--selection-overlay: rgba(255, 255, 255, 0.03);

		/* AlphaTab notation colors - Dark Theme */
		--alphatab-main-glyph: #f1f5f9; /* slate-100 */
		--alphatab-secondary-glyph: rgba(241, 245, 249, 0.6); /* slate-100 60% */
		--alphatab-staff-line: #475569; /* slate-600 */
		--alphatab-bar-separator: #475569; /* slate-600 */
		--alphatab-bar-number: #94a3b8; /* slate-400 */
		--alphatab-score-info: #cbd5e1; /* slate-300 */
	}

	/* 全局焦点样式重置 - 统一使用蓝色焦点环 */
	*:focus {
		outline: none;
	}

	*:focus-visible {
		outline: none;
		box-shadow: 0 0 0 1px rgb(59 130 246); /* blue-500 */
		border-radius: 2px;
	}

	/* CodeMirror 编辑器不需要焦点框线（已有光标指示） */
	.cm-editor:focus-visible,
	.cm-editor *:focus-visible,
	.cm-content:focus-visible,
	.cm-scroller:focus-visible {
		outline: none;
		box-shadow: none;
	}

	/* 按钮和交互元素的焦点样式 */
	button:focus-visible,
	[role="button"]:focus-visible,
	a:focus-visible {
		outline: none;
		box-shadow: 0 0 0 1px rgb(59 130 246); /* blue-500 */
	}

	/* 输入框焦点样式 */
	input:focus-visible,
	textarea:focus-visible,
	select:focus-visible {
		outline: none;
		box-shadow: 0 0 0 1px rgb(59 130 246);
		border-color: rgb(59 130 246);
	}

	/* Global base rules moved here to avoid descending specificity */
	* {
		@apply border-border;
	}
	body {
		@apply bg-background text-foreground;
	}
	/* App-wide selection styling: use the subtle overlay for selection while keeping text readable */
	::selection {
		background-color: var(--selection-overlay);
		color: inherit;
	}

	/* Ensure selection within CodeMirror lines uses the same overlay */
	.cm-content ::selection,
	.cm-line ::selection {
		background-color: var(--selection-overlay);
		color: inherit;
	}

	/* Global scrollbar styling for modern Chromium and Firefox
	* - Hide native arrow buttons, ensure track is transparent, and use rounded thumb
	* - Colors rely on theme variables so they adapt to .dark mode
	*/
	*::-webkit-scrollbar {
		width: 10px;
		height: 10px;
	}
	*::-webkit-scrollbar-track {
		background: transparent;
	}
	*::-webkit-scrollbar-thumb {
		background-color: hsl(var(--border) / 0.7);
		border-radius: 9999px;
		border: 2px solid transparent;
		background-clip: padding-box;
	}
	*::-webkit-scrollbar-button {
		display: none;
		width: 0;
		height: 0;
	}
	*::-webkit-scrollbar-corner {
		background: transparent;
	}
	/* Firefox specific */
	* {
		scrollbar-width: thin;
		scrollbar-color: hsl(var(--border) / 0.7) transparent;
	}
}

/* AlphaTab playback cursor & highlights (from alphaTab docs & in-app customizations) */
.alpha-cursor,
.at-cursor-bar {
	pointer-events: none; /* allow clicks to pass to alphaTab UI */
	position: absolute;
	background: rgba(
		255,
		242,
		0,
		0.25
	); /* yellow translucent, same as alphaTab default */
	transition:
		left 100ms linear,
		top 100ms linear,
		width 100ms linear,
		height 100ms linear;
	z-index: 20;
	border-radius: 2px;
}

.at-cursor-beat {
	/* beat cursor is a narrow vertical bar */
	position: absolute;
	pointer-events: none;
	background: rgba(64, 64, 255, 0.75); /* more vivid blue */
	width: 3px;
	z-index: 25;
	transition:
		left 80ms linear,
		top 80ms linear;
}

.at-selection div {
	background: rgba(64, 64, 255, 0.1);
}

.at-highlight * {
	/* highlight music symbols during playback */
	fill: #0078ff;
	stroke: #0078ff;
}

/* (duplicate global base block removed) */

/* Hide native up/down buttons on number inputs while preserving keyboard focus.
	 We provide UI buttons outside the input for increment/decrement.
*/
.input-no-spinner::-webkit-outer-spin-button,
.input-no-spinner::-webkit-inner-spin-button {
	-webkit-appearance: none;
	margin: 0;
}
.input-no-spinner {
	-moz-appearance: textfield;
	appearance: textfield;
}

/* Remove text background highlighting in code blocks */
/* 需要覆盖 react-syntax-highlighter 的内联样式 */
.code-block-no-text-bg span,
.code-block-no-text-bg span[style*="background"],
.code-block-no-text-bg span[style*="background-color"] {
	/* biome-ignore lint/complexity/noImportantStyles: Need to override react-syntax-highlighter inline styles */
	background: transparent !important;
	/* biome-ignore lint/complexity/noImportantStyles: Need to override react-syntax-highlighter inline styles */
	background-color: transparent !important;
}
